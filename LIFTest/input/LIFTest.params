//
// LIFTest.params
//
// created by peteschultz: Aug 3, 2012
//

//  A params file for to test LIF, GapLayer, LIFGapLayer, SigmoidLayer
//

debugParsing = false;

HyPerCol "column" = {
   nx = 256;   
   ny = 256;
   dt = 0.03125;
   randomSeed = 1;  // if not set here,  clock time is used to generate seed
   numSteps = 1600;
   progressStep = 160;
   outputPath = "output/";
   filenamesContainLayerNames = false;
   checkpointRead = false;
   checkpointWrite = false;
   // checkpointWriteDir = "Checkpoints";
   // checkpointWriteStepInterval = 1;
   // deleteOlderCheckpoints = false;
   suppressLastOutput = false;
};

//
// layers
//

Image "input" = {
    restart = 0;
    nxScale = 1;
    nyScale = 1;
    imagePath = "input/inputimage.pvp";
    nf = 1;
    marginWidth = 0;
    writeStep = -1;
    spikingFlag = false;
    writeNonspikingActivity = true;
    mirrorBCflag = false;
    writeImages = false;
    offsetX = 0;
    offsetY = 0;
};

ANNLayer "scaled input" = {
    restart = 0;
    nxScale = 1;
    nyScale = 1;
    nf = 1;
    marginWidth = 0;
    writeStep = -1.0;
    mirrorBCflag = 0;
    spikingFlag = 0;
    writeNonspikingActivity = 1;

    InitVType = "ZeroV";

    VThresh = -infinity;
    VMax = infinity;
    VMin = -infinity;
};

LIFGap "LIFTest" = {
    restart = 0;
    nxScale = 1;
    nyScale = 1;
    nf = 1;
    marginWidth = 1;
    writeStep = -1.0;
    mirrorBCflag = false;
    spikingFlag = true;
    
    InitVType        = "ConstantV";
    valueV           = -70.0;
    Vrest            = -70.0;    // adjusted for gap of 0.025   
    Vexc             = 0.0;     // reversal potential 
    Vinh             = -75.0;   // chloride channel
    VinhB            = -90.0;   // potassium reversal
    tau              = 15.0;    // intrinsic leak membrane time constant (max)
    tauE             = 1.0;     // how long glutamine stays bound
    tauI             = 5.0;     // how long GABA stays bound
    tauIB            = 10.0;    // inhibitory potassium channel 
    VthRest          = -55.0;   // firing threshold
    tauVth           = 10.0;    // relative refractory period
    deltaVth         = 5.0;     // jump of threshold when firing
    noiseAmpE        = 0.5;     // 1 means conductance is equal to lead conductance               <======== no noise  
    noiseAmpI        = 0.5;     // "twice as easy for the membrane capacitance to discharge"
    noiseAmpIB       = 0.0;     // no noise here 
    noiseFreqE       =  0.;     // spontaneous transmitter release/channel openings
    noiseFreqI       =  0.;     // correlation to time step size !!!
    noiseFreqIB      =   0.;    // should be scaled by the time constant - look at LIF model
};

GenerativeLayer "LIFTest Spike Counter" = {
    restart = false;
    nxScale = 1;
    nyScale = 1;
    nf = 1;
    marginWidth = 0;
    mirrorBCflag = false;
    spikingFlag = false;
    
    InitVType = "ConstantV";
    valueV = 0;

    writeStep = -1.0;
    writeNonspikingActivity = false;
    VMax = infinity;
    VMin = -infinity;
    VThresh = -infinity;
    relaxation = 1;
    activityThreshold = 0.0;
    auxChannelCoeff = 0.0;
    sparsityTermCoefficient = 0.0;
    persistence = 0.0;
};

GapLayer "GapTest" ={
    restart      = false;
    originalLayerName="LIFTest";
    nxScale      = 1; // Should this be 0.5 or 1?
    nyScale      = 1; // Should this be 0.5 or 1?
    nf = 1;
    marginWidth  = 1;
    mirrorBCflag = true;
    spikingFlag = false;

    InitVType    = "ConstantV";
    valueV = -70.0;

    writeStep = -1;
    writeNonspikingActivity = true;
};

LIFGap "LIFGapTest" = {
    restart = 0;
    nxScale = 1;
    nyScale = 1;
    nf = 1;
    marginWidth = 0;
    writeStep = 0.0; // Value 0 means write every timestep, no matter what dt is
    mirrorBCflag = false;
    spikingFlag = true;
    
    InitVType        = "ConstantV";
    valueV           = -70.0;
    Vrest            = -70.0;    // adjusted for gap of 0.025   
    Vexc             = 0.0;     // reversal potential 
    Vinh             = -75.0;   // chloride channel
    VinhB            = -90.0;   // potassium reversal
    tau              = 15.0;    // intrinsic leak membrane time constant (max)
    tauE             = 1.0;     // how long glutamine stays bound
    tauI             = 5.0;     // how long GABA stays bound
    tauIB            = 10.0;    // inhibitory potassium channel 
    VthRest          = -65.0;   // firing threshold
    tauVth           = 10.0;    // relative refractory period
    deltaVth         = 5.0;     // jump of threshold when firing
    noiseAmpE        = 0.5;     // 1 means conductance is equal to lead conductance               <======== no noise  
    noiseAmpI        = 0.5;     // "twice as easy for the membrane capacitance to discharge"
    noiseAmpIB       = 0.0;     // no noise here 
    noiseFreqE       =  0.;     // spontaneous transmitter release/channel openings
    noiseFreqI       =  0.;     // correlation to time step size !!!
    noiseFreqIB      =   0.;    // should be scaled by the time constant - look at LIF model
};

GenerativeLayer "LIFGapTest Spike Counter" = {
    restart = false;
    nxScale = 1;
    nyScale = 1;
    nf = 1;
    marginWidth = 0;
    mirrorBCflag = false;
    spikingFlag = false;
    
    InitVType = "ConstantV";
    valueV = 0;

    writeStep = -1.0;
    writeNonspikingActivity = false;
    VMax = infinity;
    VMin = -infinity;
    VThresh = -infinity;
    relaxation = 1;
    activityThreshold = 0.0;
    auxChannelCoeff = 0.0;
    sparsityTermCoefficient = 0.0;
    persistence = 0.0;
};

KernelConn "input to scaled input" = {
    preLayerName = "input";
    postLayerName = "scaled input";
    channelCode = 0;
    nxp = 1;
    nyp = 1;
    nfp = 1;
    numAxonalArbors = 1;
    delay = 0;

    writeStep = -1;
    initFromLastFlag = 0;
    
    weightInitType = "OneToOneWeights";
    weightInit = 1.0;
      
    normalize = false;
    symmetrizeWeights = false;
    plasticityFlag = false;
    stochasticReleaseFlag = false;
    writeCompressedWeights = true;
    selfFlag = false;
    shrinkPatches = false;
    
};

IdentConn "scaled input to LIFTest" = {
    channelCode = 0;
    delay = 0;
    
    writeStep = -1;
};

IdentConn "LIFTest to LIFTest Spike Counter" = {
    channelCode = 0;
    delay = 0;
    
    writeStep = -1;
};

GapConn "GapTest to LIFGapTest" = {
    preLayerName = "GapTest";
    postLayerName = "LIFGapTest";
    // channelCode = 3;
    nxp = 3;
    nyp = 3;
    nfp = 1;
    numAxonalArbors = 1;
    delay = 0;
    
    weightInitType = "Gauss2DWeight";
    strength      = 2.0; // 2.0 ZERO  for nogap   HoriGapHorizontal staerke
    rMin          = 0.0; // 0.1; // take out the self connection
    aspect        = 1.0;
    // rotate        = 1.0; // relevant for Gauss or cocircular, by 1/2 half the diff. between orient 
    sigma         = 3.0;
    rMax          = 256.; // maximum distance of connection
    normalize     = true; // 
    normalize_max = false;        // all flags zero means it normalize total integrated output
    normalize_zero_offset = false;  //
    normalize_cutoff      = false;  //
    
    symmetrizeWeights = false;
    plasticityFlag = false;
    stochasticReleaseFlag = false;
    selfFlag = false;
    shrinkPatches = false;
    
    writeCompressedWeights = false;
    writeStep = -1;
    // initialWriteTime = 0;
};

IdentConn "LIFGapTest to LIFGapTest Spike Counter" = {
    channelCode = 0;
    delay = 0;
    
    writeStep = -1;
};

PointProbe "Scaled Input PointProbe 012" = {
    targetLayer = "scaled input";
    message = "Scaled Input PointProbe 169 012";
    probeOutputFile = "ScaledInputProbe_012.txt";
    xLoc = 169;
    yLoc = 12;
    fLoc = 0;
};

PointLIFProbe "LIFTest PointLIFProbe 012" = {
    targetLayer = "LIFTest";
    message = "LIFTest Layer PointLIFProbe 169 012";
    probeOutputFile = "LIFTestProbe_012.txt";
    xLoc = 169;
    yLoc = 12;
    fLoc = 0;
};

PointProbe "GapTest PointProbe 012" = {
    targetLayer = "GapTest";
    message = "GapTest PointProbe 169 012";
    probeOutputFile = "GapTestProbe_012.txt";
    xLoc = 169;
    yLoc = 12;
    fLoc = 0;
};

PointLIFProbe "LIFGapTest PointLIFProbe 012" = {
    targetLayer = "LIFGapTest";
    message = "LIFGapTest PointLIFProbe 169 012";
    probeOutputFile = "LIFGapTestProbe_012.txt";
    xLoc = 169;
    yLoc = 12;
    fLoc = 0;
};

PointProbe "Scaled Input PointProbe 243" = {
    targetLayer = "scaled input";
    message = "Scaled Input PointProbe 169 243";
    probeOutputFile = "ScaledInputProbe_243.txt";
    xLoc = 169;
    yLoc = 243;
    fLoc = 0;
};

PointLIFProbe "LIFTest PointLIFProbe 243" = {
    targetLayer = "LIFTest";
    message = "LIFTest Layer PointLIFProbe 169 243";
    probeOutputFile = "LIFTestProbe_243.txt";
    xLoc = 169;
    yLoc = 243;
    fLoc = 0;
};

PointProbe "GapTest PointProbe 243" = {
    targetLayer = "GapTest";
    message = "GapTest PointProbe 169 243";
    probeOutputFile = "GapTestProbe_243.txt";
    xLoc = 169;
    yLoc = 243;
    fLoc = 0;
};

PointLIFProbe "LIFGapTest PointLIFProbe 243" = {
    targetLayer = "LIFGapTest";
    message = "LIFGapTest PointLIFProbe 169 243";
    probeOutputFile = "LIFGapTestProbe_243.txt";
    xLoc = 169;
    yLoc = 243;
    fLoc = 0;
};
